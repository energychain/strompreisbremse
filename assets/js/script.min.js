const getUrlParameter=function(t){var e,r,n=window.location.search.substring(1).split("&");for(r=0;r<n.length;r++)if((e=n[r].split("="))[0]===t)return void 0===e[1]||decodeURIComponent(e[1]);return!1},calculateBremse=function(){$("#bremseffekt").html("<span class='text-muted'>Berechnung läuft...</span>");const t=new Date("2023-01-01").getTime(),e=new Date("2023-01-31").getTime(),r=$("#inputJA").val();$.getJSON("https://api.corrently.io/v2.0/loadprofile/retrieve?from="+t+"&to="+e+"&consumption="+r,(function(t){const e=Math.round(t.output.sum.h0),r=Math.round(.8*e),n=Math.round(e+e*($("#consumptionChange").val()/100)),a=n*($("#inputPrice").val()/100),i=.4*r;let o=n-r;o<0&&(o=0);const s=o*($("#inputPrice").val()/100);let d='<table class="table table-condensed">';d+='<tr><td>Stromverbrauch Vorjahr</td><td align="right">'+e+" kWh</td></tr>",d+='<tr><td>&nbsp;&nbsp;&nbsp;davon 80% als Basisbedarf des historischen Verbrauchs</td><td align="right">'+r+" kWh</td></tr>",d+='<tr><td>Stromverbrauch jetzt (Mehr/Minderverbrauch)</td><td align="right">'+n+" kWh</td></tr>",d+='<tr><td>Stromkosten laut Tarif (ohne Bremse)</td><td align="right">'+Math.round(a)+" €</td></tr>",d+="<tr><td>&nbsp;&nbsp;&nbsp;Preisbremse für "+r+' kWh</td><td align="right">'+Math.round(i)+" €</td></tr>",d+="<tr><td>&nbsp;&nbsp;&nbsp;Tarifpreis für "+o+' kWh</td><td align="right">'+Math.round(s)+" €</td></tr>",d+='<tr><td><strong>Stromkosten mit Bremse</strong></td><td align="right"><strong>'+Math.round(i+s)+" €</strong></td></tr>",d+='<tr><td>&nbsp;&nbsp;&nbsp;Ersparnis in Euro</td><td align="right">-'+Math.round(a-(i+s))+" €</td></tr>",d+='<tr><td>&nbsp;&nbsp;&nbsp;Ersparnis in Prozent</td><td align="right">-'+Math.round((a-(i+s))/a*100)+" %</td></tr>",d+='<tr><td>Effektiver Strompreis je kWh</td><td align="right">'+Math.round((i+s)/n*100)/100+" €/kWh</td></tr>",d+="</table>",$("#bremseffekt").html(d)}))};$(document).ready((function(){$("button").on("click",(function(){location.href="#meineStrompreisbremse"})),$(".btnJAT").on("click",(function(t){$("#inputJA").val($(t.currentTarget).attr("data")),calculateBremse()})),$("#fromDate").val((new Date).getFullYear()+"-01-01"),$("#toDate").val((new Date).toISOString().substring(0,10)),$("#frmSLP").on("submit",(function(t){t.preventDefault(),$(".hideOnCalc").attr("disabled","disabled");const e=new Date($("#fromDate").val()).getTime(),r=new Date($("#toDate").val()).getTime();return $.getJSON("https://api.corrently.io/v2.0/loadprofile/retrieve?from="+e+"&to="+r+"&consumption=1000",(function(t){const e=t.output.sum.h0,r=($("#toReading").val()-$("#fromReading").val())/1e3;$("#inputJA").val(Math.round(e*r)),setTimeout((function(){$(".hideOnCalc").removeAttr("disabled"),calculateBremse()}),2e3)})),!1})),$("#inputJA").on("change",calculateBremse),$("#consumptionChange").on("change",calculateBremse),$("#inputPrice").on("change",calculateBremse),getUrlParameter("ja")&&($("#inputJA").val(getUrlParameter("ja")),calculateBremse(),location.href="#meineStrompreisbremse"),calculateBremse()})),void 0!==navigator.serviceWorker&&navigator.serviceWorker.register("pwabuilder-sw.js");